<!DOCTYPE html>
<html>
<head>
    <title>Encryption Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
</head>
<body>
    <h1>Encryption Test</h1>
    <div id="output"></div>

    <script type="module">
        // Import the encryption module
        import { E2EEncryption } from './src/utils/encryption.ts';

        async function testEncryption() {
            const output = document.getElementById('output');
            
            try {
                // Test with a hex string (like the one generated by hashPassword)
                const hexSecret = CryptoJS.SHA256('test-secret').toString();
                console.log('Hex secret:', hexSecret);
                
                const message = 'Hello, this is a test message!';
                console.log('Original message:', message);
                
                // Encrypt the message
                const encrypted = await E2EEncryption.encryptMessage(message, hexSecret);
                console.log('Encrypted:', encrypted);
                
                // Decrypt the message
                const decrypted = await E2EEncryption.decryptMessage(encrypted, hexSecret);
                console.log('Decrypted:', decrypted);
                
                if (decrypted.verified && decrypted.message === message) {
                    output.innerHTML = '<p style="color: green;">✅ Encryption/Decryption test PASSED!</p>';
                    output.innerHTML += `<p>Original: ${message}</p>`;
                    output.innerHTML += `<p>Decrypted: ${decrypted.message}</p>`;
                } else {
                    output.innerHTML = '<p style="color: red;">❌ Encryption/Decryption test FAILED!</p>';
                    output.innerHTML += `<p>Original: ${message}</p>`;
                    output.innerHTML += `<p>Decrypted: ${decrypted.message}</p>`;
                    output.innerHTML += `<p>Verified: ${decrypted.verified}</p>`;
                }
                
            } catch (error) {
                console.error('Test failed:', error);
                output.innerHTML = `<p style="color: red;">❌ Test failed: ${error.message}</p>`;
            }
        }

        // Run the test
        testEncryption();
    </script>
</body>
</html> 